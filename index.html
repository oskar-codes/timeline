<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline</title>
    <style>
      body,html {
        margin: 0;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <canvas></canvas>

    <script src="tinycolor.js"></script>
    <script src="simple-canvas.js"></script>
    <script>
      var canvas = document.querySelector("canvas");
      var ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      setupCanvas(ctx);

      function init() {
        preventcontextmenu();

        window.data = [
          {
            name: "Salvador Dali",
            start: 1904,
            end: 1989,
            color: "#ffff80"
          },
          {
            name: "Georges Braque",
            start: 1882,
            end: 1963,
            color: "#ffff80"
          },
          {
            name: "John Baldessari",
            start: 1931,
            end: 2020,
            color: "#ffff80"
          },
          {
            name: "Edward Ruscha",
            start: 1937,
            end: -1,
            color: "#ffff80"
          },
          {
            name: "Ellsworth Kelly",
            start: 1923,
            end: 2015,
            color: "lightgreen"
          },
          {
            name: "Sol Lewitt",
            start: 1928,
            end: 2007,
            color: "lightgreen"
          },
          {
            name: "Chris Burden",
            start: 1946,
            end: 2015,
            color: "lightgreen"
          },
          {
            name: "Jean-Michel Basquiat",
            start: 1960,
            end: 1988,
            color: "lightblue"
          },
          {
            name: "Andy Warhol",
            start: 1928,
            end: 1987,
            color: "lightblue"
          },
          {
            name: "Pablo Picasso",
            start: 1881,
            end: 1973,
            color: "lightblue"
          },
          {
            name: "Henri Matisse",
            start: 1869,
            end: 1954,
            color: "lightblue"
          },
          {
            name: "René Magritte",
            start: 1898,
            end: 1967,
            color: "lightblue"
          },
          {
            name: "Giorgio De Chirico",
            start: 1888,
            end: 1978,
            color: "lightblue"
          },
          {
            name: "Richard Serra",
            start: 1938,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Elliott Erwitt",
            start: 1928,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Henri Cartier-Bresson",
            start: 1908,
            end: 2004,
            color: "lightblue"
          },
          {
            name: "Anton Corbijn",
            start: 1955,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Hiroshi Sugimoto",
            start: 1948,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Jean Dieuzaide",
            start: 1921,
            end: 2003,
            color: "lightblue"
          },
          {
            name: "Sebastião Salgado",
            start: 1944,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Helmut Newton",
            start: 1920,
            end: 2004,
            color: "lightblue"
          },
          {
            name: "René Burri",
            start: 1933,
            end: 2014,
            color: "lightblue"
          },
          {
            name: "Robert Capa",
            start: 1913,
            end: 1954,
            color: "lightblue"
          },
          {
            name: "Jeff Wall",
            start: 1946,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Cindy Sherman",
            start: 1954,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Mark Rothko",
            start: 1903,
            end: 1970,
            color: "lightblue"
          },
          {
            name: "Louise Bourgeois",
            start: 1911,
            end: 2010,
            color: "lightblue"
          },
          {
            name: "Vincent Van Gogh",
            start: 1853,
            end: 1890,
            color: "lightblue"
          },
          {
            name: "Paul Cézanne",
            start: 1839,
            end: 1906,
            color: "lightblue"
          },
          {
            name: "Robert Frank",
            start: 1924,
            end: 2019,
            color: "lightblue"
          },
          {
            name: "Yves Klein",
            start: 1928,
            end: 1962,
            color: "lightblue"
          },
          {
            name: "Bruce Nauman",
            start: 1941,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Michael Heizer",
            start: 1944,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Robert Smithson",
            start: 1938,
            end: 1973,
            color: "lightblue"
          },
          {
            name: "Robert Therrien",
            start: 1947,
            end: 2019,
            color: "lightblue"
          },
          {
            name: "Joseph Beuys",
            start: 1921,
            end: 1986,
            color: "lightblue"
          },
          {
            name: "On Kawara",
            start: 1932,
            end: 2014,
            color: "lightblue"
          },
          {
            name: "Frank Stella",
            start: 1936,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Marcel Duchamp",
            start: 1887,
            end: 1968,
            color: "lightblue"
          },
          {
            name: "Ben Vautier",
            start: 1935,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Rémy Zaugg",
            start: 1943,
            end: 2005,
            color: "lightblue"
          },
          {
            name: "Carl André",
            start: 1935,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Mathias Faldbacken",
            start: 1973,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Josh Smith",
            start: 1976,
            end: -1,
            color: "lightblue"
          },
          {
            name: "David Hockney",
            start: 1937,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Félix González-Torres",
            start: 1957,
            end: 1996,
            color: "lightblue"
          },
          {
            name: "Ad Reinhardt",
            start: 1913,
            end: 1967,
            color: "lightblue"
          },
          {
            name: "Anselm Kiefer",
            start: 1945,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Jenny Holzer",
            start: 1950,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Wade Guyton",
            start: 1972,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Marc Chagall",
            start: 1887,
            end: 1985,
            color: "lightblue"
          },
          {
            name: "Edvard Munch",
            start: 1863,
            end: 1944,
            color: "lightblue"
          },
          {
            name: "Claude Monet",
            start: 1840,
            end: 1926,
            color: "lightblue"
          },
          {
            name: "Le Caravage",
            start: 1571,
            end: 1610,
            color: "lightblue"
          },
          {
            name: "Pierre Soulages",
            start: 1919,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Tauba Auerbach",
            start: 1981,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Fernand Leger",
            start: 1881,
            end: 1955,
            color: "lightblue"
          },
          {
            name: "Gerhard Richter",
            start: 1932,
            end: -1,
            color: "lightblue"
          },
          {
            name: "Alberto Giacometti",
            start: 1901,
            end: 1966,
            color: "lightblue"
          },
          {
            name: "Joan Miro",
            start: 1893,
            end: 1983,
            color: "lightblue"
          },
          {
            name: "Roy Lichtenstein",
            start: 1923,
            end: 1997,
            color: "lightblue"
          },
          {
            name: "Donal Judd",
            start: 1928,
            end: 1994,
            color: "lightblue"
          },
          {
            name: "John Cage",
            start: 1912,
            end: 1992,
            color: "lightblue"
          },
        ];
        data.sort(function(a, b) {
          var nameA = a.name.toUpperCase();
          var nameB = b.name.toUpperCase();
          if (nameA < nameB) return -1;
          if (nameA > nameB) return 1;
          return 0;
        });

        window.start = 1800;
        window.end = 2020;
        window.yScroll = 0;
        window.xScroll = 999999;
        window.space = 20;
      }

      function update(deltaTime) {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        cls();

        // y scrolling
        yScroll += getscrolldelta(0)*0.25;
        yScroll = clamp(yScroll,0,data.length * 50 - canvas.height + 75);
        
        // clamp x scrolling
        xScroll = clamp(xScroll,0,(end + 1 - start) * space - canvas.width + 30);

        // clamp zoom
        space = clamp(space,9,200);

        // grey lines as background of timeline
        for (var i=0; i<data.length; i++) {
          var y = 100+i*50-yScroll;
          rectfill(0,y-25,canvas.width,50,i%2 === 0  ? "#ddd" : "#bbb");
        }

        // vertical lines each 10 years
        for (var i=start; i<=end+1; i++) {
          var x = (i-start)*space+16-xScroll;
          if (i%10 === 0) {
            line(x,0,x,canvas.height)
          }
        }

        // populate timeline with characters
        for (var i=0; i<data.length; i++) {
          var p = data[i];
          var y = 100+i*50-yScroll;
          var x1 = (p.start - start) * space + 15 - xScroll;
          var x2 = (p.end - start) * space + 17 - xScroll;
          if (p.end === -1) {
            x2 = (end + 50 - start) * space + 17 - xScroll + space;
          }
          line(x1,y,x2,y,p.color,35);
          var t = p.name + " (" + p.start + (p.end !== -1 ? " - " + p.end : "") + ", "+ ((p.end === -1 ? 2020 : p.end) - p.start) +" years old)";
          var textX = x1 < 0 ? (x2 - textwidth(t) - 10 < 0 ? x2 - textwidth(t) - 10 : 5) : x1 + 5;
          text(t,textX+5,y+5,tinycolor(p.color).isLight() ? "black" : "white");
        }

        // timestamps
        rectfill(0,0,canvas.width,75,"white");
        for (var i=start; i<=end+1; i++) {
          ctx.textAlign = "center"
          var x = (i-start)*space+20-xScroll;
          ctx.save();
          ctx.rotate(-Math.PI/2);
          ctx.textAlign = "center";
          if (i === end + 1) {
            text("Living",-40,x,0,17.5);
          } else {
            //if ((x+xScroll)%75 < space || i === start) 
            text(i,-40,x,0,17.5);
          }
          ctx.restore();
        }


        // move on y axis
        if (btn("UP")) yScroll -= 10;
        if (btn("DOWN")) yScroll += 10;

        // move on x axis
        if (btn("LEFT")) xScroll -= 20;
        if (btn("RIGHT")) xScroll += 20;

        // change sorting
        if (btn("ONE")) {
          data.sort(function(a,b) {
            var nameA = a.name.toUpperCase();
            var nameB = b.name.toUpperCase();
            if (nameA < nameB) return -1;
            if (nameA > nameB) return 1;
            return 0;
          })
        }
        if (btn("TWO")) {
          data.sort(function(a,b) {
            return ((a.start + (a.end === -1 ? end : a.end)) / 2) - ((b.start + (b.end === -1 ? end : b.end)) / 2);
          })
        }
        if (btn("THREE")) {
          data.sort(function(a,b) {
            return ((b.start + (b.end === -1 ? end : b.end)) / 2) - ((a.start + (a.end === -1 ? end : a.end)) / 2);
          })
        }
        if (btn("FOUR")) {
          data.sort(function(a,b) {
            var colA = a.color.toUpperCase();
            var colB = b.color.toUpperCase();
            if (colA < colB) return -1;
            if (colA > colB) return 1;
            return 0;
          })
        }

        /*var anchor = canvas.height - 100;
        // background
        rectfill(0,anchor,300,100,"white");
        
        // zoom
        text("▲▼",20,anchor + 40,"black",24);
        text("Zoom",17,anchor + 75,"black",24,"serif");
        
        // sorting
        text("①",120,anchor + 40,"black",24);
        text("Alphabetical",120,anchor + 75,"black",24,"serif");*/
      }

      // x scrolling
      document.addEventListener("mousemove",function(e) {
        if (mousedown()) {
          xScroll -= e.movementX;
        }
      });

      function clamp(val,min,max) {
        return Math.min(Math.max(val,min),max)
      }
    </script>
  </body>
</html>
